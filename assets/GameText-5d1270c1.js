import{o as m,c as p,b as u,w as y,F as v,h as g,n as x,d as A,a as T,k as G,_ as M}from"./index-ca072c22.js";const O=""+new URL("bg-a194f9c8.png",import.meta.url).href,X={class:"game-text iface-centered"},w={class:"game-text--data"},S=["innerHTML"];function k(e,t,i,s,o,_){return m(),p("div",X,[u(G,{name:"fade"},{default:y(()=>[(m(!0),p(v,null,g(o.data,a=>(m(),p("div",{class:x(["game-text--content",o.TYPES[a.type]]),key:a.id,style:A(a.offset)},[t[0]||(t[0]=T("img",{class:"game-text--background",src:O},null,-1)),T("div",w,[T("div",{class:"title",innerHTML:a.text},null,8,S)])],6))),128))]),_:1})])}const n=0,f=1,r=2,d=3,$=4,I=5,U=6,h=7,C={props:["openParams"],data(){return{TYPES:["center-type","top-type","right-type","bottom-type","key-type"],id:0,key:0,data:[]}},created(){this.$data.noAdaptation=!0},mounted(){document.addEventListener("keyup",this.onKeyUp)},unmounted(){document.removeEventListener("keyup",this.onKeyUp)},methods:{add(e){const t=JSON.parse(e);if(window.getOpenedControllableInterfaces().length==0&&!window.IsDialogOpened()||t[I]){const i=this.id;let s=this.data.filter(o=>o.type==t[n]);if(s.length){s=s[n],clearTimeout(s.timeout);let o=s;o.text=this.formatText(t[f],t[h]),o.offset=t[d]==0?0:this.formatOffset(t[n],t[d]),t[r]>0&&(o.timeout=setTimeout(()=>{this.remove(s.id)},t[r])),this.data[this.data.indexOf(s)]=o}else t[U]&&window.playSound("notifications/UI_Notification_01.mp3",!1,2,.2),this.data.push({id:this.id++,type:t[n],text:this.formatText(t[f],t[h]),offset:t[d]==0?0:this.formatOffset(t[n],t[d]),keyCode:t[$],timeout:t[r]>0?setTimeout(()=>{this.remove(i)},t[r]):0})}},onKeyUp({keyCode:e}){this.pressKey(e)},pressKey(e){for(let t=0;t<this.data.length;t++)this.data[t].keyCode==e&&setTimeout(()=>{this.remove(this.data[t].id)},300)},hide(e){for(let t in this.data)t.type==e&&this.remove(t.id)},remove(e){this.data.filter(i=>i.id==e).length&&(this.data=this.data.filter(i=>i.id!=e))},formatOffset(e,t){const i=this.TYPES[e];let s=`margin-top: ${t/1080*100}vh`;return i!="center-type"&&(s=`margin-${i}: ${t/1080*100}vh`),s},formatText(e,t){const i=[];let s="";e.split("~n~").forEach(a=>{const E=a.split(/(?=~.~)/).map(c=>{const l=c.match(/^~(.)~(.*)/);return l&&(s=l[1],c=l[2]),`<span class="${s}">${c}</span>`}).join("");i.push(E)});const o=i.map(a=>`<div class="row">${a}</div>`).join("");return`<div style="font-size: ${t}vh">${o}</div>`.split("_").join(" ")}}},K=M(C,[["render",k]]);export{K as default};
